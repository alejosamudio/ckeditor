(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))d(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function d(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();console.info("[CKEditorBridge] Bootstrap starting",{embedded:window.parent!==window,href:window.location?.href,userAgent:navigator.userAgent});const i=(()=>{const t="CKE_BUBBLE_BRIDGE_V1",o="1.0.0",s=typeof window.location?.search=="string"?window.location.search:"",d=new URLSearchParams(s);let a=!1;try{a=window.localStorage?.getItem("ckeBridgeDebug")==="true"}catch{a=!1}let r=d.get("debug")==="1"||d.get("debug")==="true"||a||window.CKEDITOR_BRIDGE_DEBUG===!0;const l="[CKEditorBridge]",m=window.parent!==window;let u=!m,h=m?"*":window.origin;const w=new Set;let f=null,C=0;const B=20,R=[],k=[],S=[],y=new Map;let I=null;m?(w.add(window.parent),window.top&&window.top!==window&&window.top!==window.parent&&w.add(window.top)):w.add(window);const O={BRIDGE_ID:t,VERSION:o,get DEBUG(){return r},isEmbedded:m};function E(...e){r&&console.log(l,...e)}function U(e){!e||typeof e.postMessage!="function"||w.add(e)}function v(e){r=!!e;try{window.localStorage?.setItem("ckeBridgeDebug",r?"true":"false")}catch{}r?console.log(l,"Debug mode enabled"):console.log(l,"Debug mode disabled")}function H(e,n={},c={}){return{bridge:t,version:o,type:e,payload:n,direction:c.direction||"editor->parent",timestamp:Date.now(),requestId:c.requestId??null,messageId:c.messageId||`${Date.now()}-${Math.random().toString(36).slice(2,10)}`}}function L(e){const n=h||"*";w.forEach(c=>{try{c.postMessage(e,n)}catch(p){console.error(l,"Failed to postMessage to target",p)}}),E("Sent message",e,"→",n,"targets:",w.size)}function _(){if(u)for(;R.length;)L(R.shift())}function T(e,n={},c={}){const p=H(e,n,c);u||e==="EDITOR_READY"?L(p):(E("Queueing message until parent is ready",p),R.push(p))}function K(){if(!m){E("Not embedded in an iframe. Parent communication disabled."),u=!0,_();return}if(f)return;C=0;const e=()=>{C+=1,T("EDITOR_READY",{attempt:C,isEmbedded:m,userAgent:navigator.userAgent}),!r&&C===1&&console.info(`${l} EDITOR_READY #${C} → parent`,{attempt:C,isEmbedded:m,targetOrigin:h})};e(),f=window.setInterval(()=>{if(u){window.clearInterval(f),f=null;return}if(C>=B){window.clearInterval(f),f=null,E("No handshake acknowledgement received. Proceeding with wildcard origin."),u=!0,_();return}e()},500)}function D(e){e&&e!=="null"&&(h=e,E("Target origin updated to",h))}function M(e,n={}){if(u)h==="*"&&e&&e!=="null"&&D(e);else for(u=!0,n&&n.targetOrigin?h=n.targetOrigin:D(e),f&&(window.clearInterval(f),f=null),E("Handshake completed with parent."),_(),T("EDITOR_READY_ACK",{receivedAt:Date.now()});S.length;){const c=S.shift();try{c({origin:h})}catch(p){console.error(l,"Parent ready callback failed",p)}}}function F(e){I?e(I):k.push(e)}function W(e){for(I=e;k.length;){const n=k.shift();try{n(I)}catch(c){console.error(l,"Deferred editor action failed",c)}}}function G(e){typeof e=="function"&&(u?e({origin:h}):S.push(e))}function Y(e,n){typeof n=="function"&&y.set(e,n)}return window.addEventListener("message",e=>{const n=e.data;if(!n||n.bridge!==t||(m&&e.source&&!w.has(e.source)&&(U(e.source),E("Registered new parent candidate from message source")),n.direction&&n.direction!=="parent->editor"))return;E("Received message",n,"from",e.origin),!u||n.type==="PARENT_READY"?M(e.origin,n.payload||{}):h==="*"&&e.origin&&e.origin!=="null"&&D(e.origin);const c=y.get(n.type);if(c)try{c({payload:n.payload||{},requestId:n.requestId??null,event:e,send:T})}catch(p){console.error(l,`Error handling message ${n.type}`,p),T("HANDLER_ERROR",{type:n.type,message:p?.message||"Unknown handler error"})}else n.type!=="PARENT_READY"&&E("No handler registered for type",n.type)}),{send:T,startHandshake:K,setEditor:W,withEditor:F,onParentReady:G,registerHandler:Y,setDebug:v,constants:O}})();window.CKEDITOR_BUBBLE_BRIDGE=i;i.startHandshake();let N=!1;function P(t,{ackType:o,requestId:s,reason:d,focus:a}={}){i.withEditor(r=>{N=!0;let l=!1,m=null;try{r.setData(typeof t=="string"?t:""),a&&r.editing.view.focus(),l=!0}catch(u){m=u?.message||"Unknown error applying editor content.",console.error("[CKEditorBridge] Failed to apply content from parent",u),i.send("CONTENT_ERROR",{requestId:s,reason:d,message:m,timestamp:Date.now()})}window.setTimeout(()=>{N=!1,o&&i.send(o,{requestId:s,status:l?"ok":"error",reason:d,message:m,timestamp:Date.now()}),l&&i.send("CONTENT_SYNC",{requestId:s,html:r.getData(),reason:d,timestamp:Date.now()})},0)})}i.registerHandler("INIT",({payload:t,requestId:o})=>{P(t?.html??"",{ackType:"INIT_ACK",requestId:o,reason:"init",focus:t?.focus===!0})});i.registerHandler("SET_CONTENT",({payload:t,requestId:o})=>{P(t?.html??"",{ackType:"SET_CONTENT_ACK",requestId:o,reason:t?.reason||"set-content",focus:t?.focus===!0})});i.registerHandler("CLEAR_CONTENT",({requestId:t})=>{P("",{ackType:"CLEAR_CONTENT_ACK",requestId:t,reason:"clear-content"})});i.registerHandler("REQUEST_CONTENT",({requestId:t})=>{i.withEditor(o=>{i.send("CONTENT_SYNC",{requestId:t,html:o.getData(),reason:"requested-sync",timestamp:Date.now()})})});i.registerHandler("PING",({requestId:t,payload:o})=>{i.send("PONG",{requestId:t,echo:o?.echo??null,timestamp:Date.now()})});i.registerHandler("SET_DEBUG",({payload:t,requestId:o})=>{const s=typeof t?.enabled=="boolean"?t.enabled:!i.constants.DEBUG;i.setDebug(s),i.send("SET_DEBUG_ACK",{requestId:o,status:"ok",enabled:i.constants.DEBUG,timestamp:Date.now()})});const $="eyJhbGciOiJFUzI1NiJ9.eyJleHAiOjE3NjQyMDE1OTksImp0aSI6ImNiMWJiNTk0LWIxODEtNGJmMi1iZTA5LTM2ZGM1MjY3MzIxZiIsInVzYWdlRW5kcG9pbnQiOiJodHRwczovL3Byb3h5LWV2ZW50LmNrZWRpdG9yLmNvbSIsImRpc3RyaWJ1dGlvbkNoYW5uZWwiOlsiY2xvdWQiLCJkcnVwYWwiLCJzaCJdLCJ3aGl0ZUxhYmVsIjp0cnVlLCJsaWNlbnNlVHlwZSI6InRyaWFsIiwiZmVhdHVyZXMiOlsiKiJdLCJ2YyI6ImFhNmQ1YmUwIn0.a4QCfokW3f4OX2Td4j7I5Nv6J9NsaWg4atvrEmD90ijhttvsbqFMfaoJ4a-X_V0ZJ0mxSN6mMf1jjWLJGlV0dQ",X="<YOUR_DOCUMENT_ID>",ee="https://uplnolydjmzr.cke-cs.com/token/dev/9dcdd882883e3315126ce6f9865e9ec42fa58287442ece2a12be481798c5?limit=10",te="wss://uplnolydjmzr.cke-cs.com/ws";let b=0;const ne=40,oe=250;function z(){const t=window.CKEDITOR,o=window.CKEDITOR_PREMIUM_FEATURES;if(t&&o){ie(t,o);return}if(b+=1,(b===1||b%10===0)&&console.warn("[CKEditorBridge] Waiting for CKEditor globals to load...",{attempt:b}),b>=ne){const s="CKEditor UMD bundles did not load in time.";console.error("[CKEditorBridge]",s),i.send("EDITOR_ERROR",{message:s,timestamp:Date.now()});return}window.setTimeout(z,oe)}function ie(t,o){const{AccessibilityHelp:s,Alignment:d,Autoformat:a,AutoImage:r,AutoLink:l,Autosave:m,BalloonToolbar:u,BlockQuote:h,Bold:w,Bookmark:f,CKBox:C,CKBoxImageEdit:B,CKFinder:R,CloudServices:k,Code:S,CodeBlock:y,Comments:I,DecoupledEditor:O,DocumentOutline:E,Emoji:U,Enter:v,Essentials:H,FindAndReplace:L,FontBackgroundColor:_,FontColor:T,FontFamily:K,FontSize:D,FormatPainter:M,GeneralHtmlSupport:F,Heading:W,Highlight:G,HorizontalLine:Y,HtmlComment:e,HtmlEmbed:n,HtmlSupport:c,Image:p,ImageBlock:ae,ImageCaption:re,ImageInline:se,ImageInsert:le,ImageInsertViaUrl:de,ImageResize:ce,ImageStyle:me,ImageToolbar:ue,ImageUpload:ge,Indent:pe,IndentBlock:he,Italic:x,LineHeight:fe,Link:Ee,LinkImage:we,LinkImageEditing:Ce,List:Q,ListProperties:Te,Markdown:Ie,MediaEmbed:be,Mention:j,PageBreak:Re,Paragraph:ke,PasteFromMarkdownExperimental:Se,PasteFromOffice:_e,PictureEditing:De,PresenceList:ye,RealTimeCollaborativeComments:Oe,RealTimeCollaborativeEditing:Le,RealTimeCollaborativeTrackChanges:Ne,RemoveFormat:Ae,SlashCommand:Pe,SpecialCharacters:Be,SpecialCharactersArrows:Ue,SpecialCharactersCurrency:ve,SpecialCharactersEssentials:He,SpecialCharactersLatin:Ke,SpecialCharactersMathematical:Me,SpecialCharactersText:Fe,Strikethrough:We,Style:Ge,Subscript:Ye,Superscript:Ve,Table:Je,TableCaption:ze,TableCellProperties:xe,TableColumnResize:Qe,TableProperties:je,TableToolbar:Ze,TextTransformation:qe,TodoList:$e,TrackChanges:Xe,TrackChangesData:et,TrackChangesPreview:tt,Underline:nt}=t,{AIChat:ot,AIEditorIntegration:it,AIQuickActions:at,AIReviewMode:rt,PasteFromOfficeEnhanced:st,FormatPainter:lt,LineHeight:dt,RealTimeCollaborativeComments:ct,RealTimeCollaborativeEditing:mt,PresenceList:ut,Comments:gt,RealTimeCollaborativeTrackChanges:pt,TrackChanges:ht,TrackChangesData:ft,TrackChangesPreview:Et,SlashCommand:wt}=o,V={autosave:{waitingTime:5e3,save(){}},toolbar:{items:["undo","redo","|","trackChanges","comment","commentsArchive","|","toggleAi","aiQuickActions","|","formatPainter","findAndReplace","|","heading","style","fontSize","fontFamily","lineHeight","fontColor","fontBackgroundColor","|","bold","italic","underline","strikethrough","subscript","superscript","code","removeFormat","|","link","blockQuote","insertTable","insertImage","mediaEmbed","horizontalLine","specialCharacters","codeBlock","|","bulletedList","numberedList","todoList","|","outdent","indent","|","alignment"],shouldNotGroupWhenFull:!0},ai:{container:{type:"overlay",side:"right"},chat:{models:{},context:{document:{enabled:!0},urls:{enabled:!0},files:{enabled:!0}}}},balloonToolbar:["comment","|","aiQuickActions","|","bold","italic","|","link","insertImage","|","bulletedList","numberedList"],cloudServices:{tokenUrl:ee,webSocketUrl:te},collaboration:{channelId:X},comments:{editorConfig:{extraPlugins:[a,w,x,Q,j],mention:{feeds:[{marker:"@",feed:[]}]}}},fontFamily:{supportAllValues:!0},fontSize:{options:[10,12,14,"default",18,20,22],supportAllValues:!0},heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},image:{toolbar:["toggleImageCaption","|","imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight","|","resizeImage","|","ckboxImageEdit"],styles:{options:["alignBlockLeft","block","alignBlockRight"]}},initialData:"<p>Start writing...</p>",licenseKey:$,lineHeight:{supportAllValues:!0},link:{addTargetToExternalLinks:!0,defaultProtocol:"https://",decorators:{toggleDownloadable:{mode:"manual",label:"Downloadable",attributes:{download:"file"}}}},list:{properties:{styles:!0,startIndex:!0,reversed:!0}},mention:{feeds:[{marker:"@",feed:[]}]},placeholder:"Type or paste your content here!",presenceList:{container:document.querySelector("#editor-presence")},sidebar:{container:document.querySelector("#editor-annotations")},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableProperties","tableCellProperties"]}};A(V);const Z=250;O.create(document.querySelector("#editor"),V).then(g=>{document.querySelector("#editor-toolbar").appendChild(g.ui.view.toolbar.element),document.querySelector("#editor-menu-bar").appendChild(g.ui.view.menuBarView.element),window.editor=g,i.setEditor(g);let J;return g.model.document.on("change:data",()=>{N||(window.clearTimeout(J),J=window.setTimeout(()=>{const q=g.getData();i.send("CONTENT_CHANGE",{html:q,reason:"user-input",timestamp:Date.now()})},Z))}),i.onParentReady(()=>{i.send("CONTENT_SYNC",{html:g.getData(),reason:"initial-sync",timestamp:Date.now()})}),i.startHandshake(),g}).catch(g=>{console.error(g),i.send("EDITOR_ERROR",{message:g?.message||"Failed to initialize CKEditor.",stack:g?.stack||null,timestamp:Date.now()})})}z();function A(t){if(A.configUpdateAlertShown)return;const o=(d,a)=>d!==a&&d!==void 0,s=[];A.configUpdateAlertShown=!0,o(t.licenseKey,"<YOUR_LICENSE_KEY>")||s.push("LICENSE_KEY"),o(t.cloudServices?.tokenUrl,"<YOUR_CLOUD_SERVICES_TOKEN_URL>")||s.push("CLOUD_SERVICES_TOKEN_URL"),o(t.cloudServices?.webSocketUrl,"<YOUR_CLOUD_SERVICES_WEBSOCKET_URL>")||s.push("CLOUD_SERVICES_WEBSOCKET_URL"),s.length&&window.alert(["Please update the following values in your editor config","to receive full access to Premium Features:","",...s.map(d=>` - ${d}`)].join(`
`))}
